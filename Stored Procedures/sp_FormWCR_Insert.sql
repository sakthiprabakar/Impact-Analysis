
--/************************************************************
--Procedure	: sp_FormWCR_Insert
--Database	: PLT_AI*
--Created		: 5-10-2004 - Jonathan Broome
--Description	: Inserts waste information
--			  into the FormWCR table.
--12/16/2004 JPB Modified to take Generator_id and EPA_ID
-- 07/08/2019	JPB	Cust_name: 40->75 / Generator_Name: 40->75
--************************************************************/
--Create Procedure sp_FormWCR_Insert (
--@form_id						int,
--@revision_id					int,
--@group_id						int 			= NULL,
--@customer_id_from_form			int				= NULL,
--@customer_id					int				= NULL,
--@selected_companies				varchar(8000),
--@form_version					char(10) 		= NULL,
--@app_id							varchar(20)		= NULL,
--@tracking_id					int				= NULL,
--@status							char(1),
--@locked							char(1),
--@signed_pin						char(10) 		= NULL,
--@signing_name					varchar(40) 	= NULL,
--@signing_company				varchar(40) 	= NULL,
--@signing_title					varchar(40) 	= NULL,
--@signing_date					datetime 		= NULL,
--@username						char(10),
--@comments						text 			= NULL,
--@sample_id						int				= NULL,
--@cust_name						varchar(75)		= NULL,
--@cust_addr1						varchar(75)		= NULL,
--@cust_addr2						varchar(75)		= NULL,
--@cust_addr3						varchar(75)		= NULL,
--@cust_addr4						varchar(75)		= NULL,
--@cust_city						varchar(40)		= NULL,
--@cust_state						char(2)			= NULL,
--@cust_zip						varchar(10)		= NULL,
--@cust_country					varchar(50)		= NULL,
--@inv_contact_name				varchar(40)		= NULL,
--@inv_contact_phone				varchar(20)		= NULL,
--@inv_contact_fax				varchar(10)		= NULL,
--@tech_contact_name				varchar(40)		= NULL,
--@tech_contact_phone				varchar(20)		= NULL,
--@tech_contact_fax				varchar(10)		= NULL,
--@tech_contact_mobile			varchar(10)		= NULL,
--@tech_contact_pager				varchar(10)		= NULL,
--@tech_cont_email				varchar(50)		= NULL,
--@generator_id					int				= NULL,
--@epa_id							varchar(12)		= NULL,
--@sic_code						int				= NULL,
--@generator_name					varchar(75)		= NULL,
--@generator_address1				varchar(75)		= NULL,
--@generator_address2				varchar(75)		= NULL,
--@generator_address3				varchar(75)		= NULL,
--@generator_address4				varchar(75)		= NULL,
--@generator_city					varchar(40)		= NULL,
--@generator_state				varchar(40)		= NULL,
--@generator_zip					varchar(10)		= NULL,
--@generator_county_id			int				= NULL,
--@generator_county_name			varchar(40)		= NULL,
--@gen_mail_address1				varchar(40)		= NULL,
--@gen_mail_address2				varchar(40)		= NULL,
--@gen_mail_address3				varchar(40)		= NULL,
--@gen_mail_city					varchar(40)		= NULL,
--@gen_mail_state					char(2)			= NULL,
--@gen_mail_zip					varchar(10)		= NULL,
--@generator_contact				varchar(40)		= NULL,
--@generator_contact_title		varchar(20)		= NULL,
--@generator_phone				varchar(20)		= NULL,
--@generator_fax					varchar(10)		= NULL,
--@waste_common_name				char(50)		= NULL,
--@volume							varchar(20)		= NULL,
--@frequency						varchar(20)		= NULL,
--@dot_shipping_name				varchar(130)	= NULL,
--@surcharge_exempt				char(1)			= NULL,
--@pack_bulk_solid_yard			char(1)			= NULL,
--@pack_bulk_solid_ton			char(1)			= NULL,
--@pack_bulk_liquid				char(1)			= NULL,
--@pack_totes						char(1)			= NULL,
--@pack_totes_size				varchar(30)		= NULL,
--@pack_cy_box					char(1)			= NULL,
--@pack_drum						char(1)			= NULL,
--@pack_other						char(1)			= NULL,
--@pack_other_desc				varchar(15)		= NULL,
--@color							varchar(25)		= NULL,
--@odor							varchar(25)		= NULL,
--@poc							char(1)			= NULL,
--@consistency_solid				char(1)			= NULL,
--@consistency_dust				char(1)			= NULL,
--@consistency_liquid				char(1)			= NULL,
--@consistency_sludge				char(1)			= NULL,
--@ph								char(10)		= NULL,
--@ph_lte_2						char(1)			= NULL,
--@ph_gt_2_lt_5					char(1)			= NULL,
--@ph_gte_5_lte_10				char(1)			= NULL,
--@ph_gt_10_lt_12_5				char(1)			= NULL,
--@ph_gte_12_5					char(1)			= NULL,
--@ignitability					varchar(10)		= NULL,
--@waste_contains_spec_hand_none	char(1)			= NULL,
--@free_liquids					char(1)			= NULL,
--@oily_residue					char(1)			= NULL,
--@metal_fines					char(1)			= NULL,
--@biodegradable_sorbents			char(1)			= NULL,
--@amines							char(1)			= NULL,
--@ammonia						char(1)			= NULL,
--@dioxins						char(1)			= NULL,
--@furans							char(1)			= NULL,
--@biohazard						char(1)			= NULL,
--@shock_sensitive_waste			char(1)			= NULL,
--@reactive_waste					char(1)			= NULL,
--@radioactive_waste				char(1)			= NULL,
--@explosives						char(1)			= NULL,
--@pyrophoric_waste				char(1)			= NULL,
--@isocyanates					char(1)			= NULL,
--@asbestos_friable				char(1)			= NULL,
--@asbestos_no_friable			char(1)			= NULL,
--@gen_process					text			= NULL,
--@rcra_listed					char(1)			= NULL,
--@rcra_listed_comment			text			= NULL,
--@rcra_characteristic			char(1)			= NULL,
--@rcra_characteristic_comment	text			= NULL,
--@state_waste_code_flag			char(1)			= NULL,
--@state_waste_code_flag_comment	text			= NULL,
--@wastewater_treatment			char(1)			= NULL,
--@exceed_ldr_standards			char(1)			= NULL,
--@meets_alt_soil_treatment_stds	char(1)			= NULL,
--@more_than_50_pct_debris		char(1)			= NULL,
--@oxidizer						char(1)			= NULL,
--@react_cyanide					char(1)			= NULL,
--@react_sulfide					char(1)			= NULL,
--@info_basis						varchar(10)		= NULL,
--@D004							char(1)			= NULL ,
--@D005							char(1)			= NULL ,
--@D006							char(1)			= NULL ,
--@D007							char(1)			= NULL ,
--@D008							char(1)			= NULL ,
--@D009							char(1)			= NULL ,
--@D010							char(1)			= NULL ,
--@D011							char(1)			= NULL ,
--@D012							char(1)			= NULL ,
--@D013							char(1)			= NULL ,
--@D014							char(1)			= NULL ,
--@D015							char(1)			= NULL ,
--@D016							char(1)			= NULL ,
--@D017							char(1)			= NULL ,
--@D018							char(1)			= NULL ,
--@D019							char(1)			= NULL ,
--@D020							char(1)			= NULL ,
--@D021							char(1)			= NULL ,
--@D022							char(1)			= NULL ,
--@D023							char(1)			= NULL ,
--@D024							char(1)			= NULL ,
--@D025							char(1)			= NULL ,
--@D026							char(1)			= NULL ,
--@D027							char(1)			= NULL ,
--@D028							char(1)			= NULL ,
--@D029							char(1)			= NULL ,
--@D030							char(1)			= NULL ,
--@D031							char(1)			= NULL ,
--@D032							char(1)			= NULL ,
--@D033							char(1)			= NULL ,
--@D034							char(1)			= NULL ,
--@D035							char(1)			= NULL ,
--@D036							char(1)			= NULL ,
--@D037							char(1)			= NULL ,
--@D038							char(1)			= NULL ,
--@D039							char(1)			= NULL ,
--@D040							char(1)			= NULL ,
--@D041							char(1)			= NULL ,
--@D042							char(1)			= NULL ,
--@D043							char(1)			= NULL ,
--@D004_concentration				float			= NULL ,
--@D005_concentration				float			= NULL ,
--@D006_concentration				float			= NULL ,
--@D007_concentration				float			= NULL ,
--@D008_concentration				float			= NULL ,
--@D009_concentration				float			= NULL ,
--@D010_concentration				float			= NULL ,
--@D011_concentration				float			= NULL ,
--@D012_concentration				float			= NULL ,
--@D013_concentration				float			= NULL ,
--@D014_concentration				float			= NULL ,
--@D015_concentration				float			= NULL ,
--@D016_concentration				float			= NULL ,
--@D017_concentration				float			= NULL ,
--@D018_concentration				float			= NULL ,
--@D019_concentration				float			= NULL ,
--@D020_concentration				float			= NULL ,
--@D021_concentration				float			= NULL ,
--@D022_concentration				float			= NULL ,
--@D023_concentration				float			= NULL ,
--@D024_concentration				float			= NULL ,
--@D025_concentration				float			= NULL ,
--@D026_concentration				float			= NULL ,
--@D027_concentration				float			= NULL ,
--@D028_concentration				float			= NULL ,
--@D029_concentration				float			= NULL ,
--@D030_concentration				float			= NULL ,
--@D031_concentration				float			= NULL ,
--@D032_concentration				float			= NULL ,
--@D033_concentration				float			= NULL ,
--@D034_concentration				float			= NULL ,
--@D035_concentration				float			= NULL ,
--@D036_concentration				float			= NULL ,
--@D037_concentration				float			= NULL ,
--@D038_concentration				float			= NULL ,
--@D039_concentration				float			= NULL ,
--@D040_concentration				float			= NULL ,
--@D041_concentration				float			= NULL ,
--@D042_concentration				float			= NULL ,
--@D043_concentration				float			= NULL ,
--@underlying_haz_constituents	char(1)			= NULL,
--@michigan_non_haz				char(1)			= NULL,
--@michigan_non_haz_comment		text			= NULL,
--@universal						char(1)			= NULL,
--@recyclable_commodity			char(1)			= NULL,
--@recoverable_petroleum_product	char(1)			= NULL,
--@used_oil						char(1)			= NULL,
--@pcb_concentration				varchar(10)		= NULL,
--@pcb_source_concentration_gr_50	char(1)			= NULL,
--@processed_into_non_liquid		char(1)			= NULL,
--@processd_into_nonlqd_prior_pcb	varchar(10)		= NULL,
--@pcb_non_lqd_contaminated_media	varchar(1)	  	= NULL,
--@pcb_manufacturer				char(1)			= NULL,
--@pcb_article_decontaminated		char(1)			= NULL,
--@ccvocgr500						char(1)			= NULL,
--@benzene						char(1)			= NULL,
--@neshap_sic						char(1)			= NULL,
--@tab_gr_10						char(1)			= NULL,
--@avg_h20_gr_10					char(1)			= NULL,
--@tab							float			= NULL,
--@benzene_gr_1					char(1)			= NULL,
--@benzene_concentration			float			= NULL,
--@benzene_unit					varchar(10)		= NULL,
--@fuel_blending					char(1)			= NULL,
--@btu_per_lb						char(10)		= NULL,
--@pct_chlorides					char(10)		= NULL,
--@pct_moisture					char(10)		= NULL,
--@pct_solids						char(10)		= NULL,
--@intended_for_reclamation		char(1)			= NULL
--)
--as

--DECLARE
--	@pos int,
--	@company_profitcenter varchar(30),
--	@tmp_list varchar(8000)

--exec('sp_FormXProfitCenter_Delete ' + @form_id + ', ' + @revision_id)

--set @tmp_list = replace(@selected_companies, ' ', '')
--set @pos = 0

--WHILE datalength(@tmp_list) > 0
--BEGIN
--	select @pos = CHARINDEX(',', @tmp_list)
--	if @pos > 0
--	begin
--		select @company_profitcenter = SUBSTRING(@tmp_list, 1, @pos - 1)
--		select @tmp_list = SUBSTRING(@tmp_list, @pos + 1, datalength(@tmp_list) - @pos)
--	end
--	if @pos = 0
--	begin
--		select @company_profitcenter = @tmp_list
--		select @tmp_list = NULL
--	end
--	exec('sp_FormXProfitCenter_Insert ' + @form_id + ', ' + @revision_id + ', ''' + @company_profitcenter + '''')
--END

--insert FormWCR (
--	form_id,
--	revision_id,
--	group_id,
--	customer_id_from_form,
--	customer_id,
--	form_version,
--	app_id,
--	tracking_id,
--	status,
--	locked,
--	signed_pin,
--	signing_name,
--	signing_company,
--	signing_title,
--	signing_date,
--	date_created,
--	date_modified,
--	created_by,
--	modified_by,
--	comments,
--	sample_id,
--	cust_name,
--	cust_addr1,
--	cust_addr2,
--	cust_addr3,
--	cust_addr4,
--	cust_city,
--	cust_state,
--	cust_zip,
--	cust_country,
--	inv_contact_name,
--	inv_contact_phone,
--	inv_contact_fax,
--	tech_contact_name,
--	tech_contact_phone,
--	tech_contact_fax,
--	tech_contact_mobile,
--	tech_contact_pager,
--	tech_cont_email,
--	generator_id,
--	epa_id,
--	sic_code,
--	generator_name,
--	generator_address1,
--	generator_address2,
--	generator_address3,
--	generator_address4,
--	generator_city,
--	generator_state,
--	generator_zip,
--	generator_county_id,
--	generator_county_name,
--	gen_mail_address1,
--	gen_mail_address2,
--	gen_mail_address3,
--	gen_mail_city,
--	gen_mail_state,
--	gen_mail_zip,
--	generator_contact,
--	generator_contact_title,
--	generator_phone,
--	generator_fax,
--	waste_common_name,
--	volume,
--	frequency,
--	dot_shipping_name,
--	surcharge_exempt,
--	pack_bulk_solid_yard,
--	pack_bulk_solid_ton,
--	pack_bulk_liquid,
--	pack_totes,
--	pack_totes_size,
--	pack_cy_box,
--	pack_drum,
--	pack_other,
--	pack_other_desc,
--	color,
--	odor,
--	poc,
--	consistency_solid,
--	consistency_dust,
--	consistency_liquid,
--	consistency_sludge,
--	ph,
--	ph_lte_2,
--	ph_gt_2_lt_5,
--	ph_gte_5_lte_10,
--	ph_gt_10_lt_12_5,
--	ph_gte_12_5,
--	ignitability,
--	waste_contains_spec_hand_none,
--	free_liquids,
--	oily_residue,
--	metal_fines,
--	biodegradable_sorbents,
--	amines,
--	ammonia,
--	dioxins,
--	furans,
--	biohazard,
--	shock_sensitive_waste,
--	reactive_waste,
--	radioactive_waste,
--	explosives,
--	pyrophoric_waste,
--	isocyanates,
--	asbestos_friable,
--	asbestos_no_friable,
--	gen_process,
--	rcra_listed,
--	rcra_listed_comment,
--	rcra_characteristic,
--	rcra_characteristic_comment,
--	state_waste_code_flag,
--	state_waste_code_flag_comment,
--	wastewater_treatment,
--	exceed_ldr_standards,
--	meets_alt_soil_treatment_stds,
--	more_than_50_pct_debris,
--	oxidizer,
--	react_cyanide,
--	react_sulfide,
--	info_basis,
--	D004,
--	D005,
--	D006,
--	D007,
--	D008,
--	D009,
--	D010,
--	D011,
--	D012,
--	D013,
--	D014,
--	D015,
--	D016,
--	D017,
--	D018,
--	D019,
--	D020,
--	D021,
--	D022,
--	D023,
--	D024,
--	D025,
--	D026,
--	D027,
--	D028,
--	D029,
--	D030,
--	D031,
--	D032,
--	D033,
--	D034,
--	D035,
--	D036,
--	D037,
--	D038,
--	D039,
--	D040,
--	D041,
--	D042,
--	D043,
--	D004_concentration,
--	D005_concentration,
--	D006_concentration,
--	D007_concentration,
--	D008_concentration,
--	D009_concentration,
--	D010_concentration,
--	D011_concentration,
--	D012_concentration,
--	D013_concentration,
--	D014_concentration,
--	D015_concentration,
--	D016_concentration,
--	D017_concentration,
--	D018_concentration,
--	D019_concentration,
--	D020_concentration,
--	D021_concentration,
--	D022_concentration,
--	D023_concentration,
--	D024_concentration,
--	D025_concentration,
--	D026_concentration,
--	D027_concentration,
--	D028_concentration,
--	D029_concentration,
--	D030_concentration,
--	D031_concentration,
--	D032_concentration,
--	D033_concentration,
--	D034_concentration,
--	D035_concentration,
--	D036_concentration,
--	D037_concentration,
--	D038_concentration,
--	D039_concentration,
--	D040_concentration,
--	D041_concentration,
--	D042_concentration,
--	D043_concentration,
--	underlying_haz_constituents,
--	michigan_non_haz,
--	michigan_non_haz_comment,
--	universal,
--	recyclable_commodity,
--	recoverable_petroleum_product,
--	used_oil,
--	pcb_concentration,
--	pcb_source_concentration_gr_50,
--	processed_into_non_liquid,
--	processd_into_nonlqd_prior_pcb,
--	pcb_non_lqd_contaminated_media,
--	pcb_manufacturer,
--	pcb_article_decontaminated,
--	ccvocgr500,
--	benzene,
--	neshap_sic,
--	tab_gr_10,
--	avg_h20_gr_10,
--	tab,
--	benzene_gr_1,
--	benzene_concentration,
--	benzene_unit,
--	fuel_blending,
--	btu_per_lb,
--	pct_chlorides,
--	pct_moisture,
--	pct_solids,
--	intended_for_reclamation
--    , rowguid
--) values (
--	@form_id,
--	@revision_id,
--	@group_id,
--	@customer_id_from_form,
--	@customer_id,
--	@form_version,
--	@app_id,
--	@tracking_id,
--	@status,
--	@locked,
--	@signed_pin,
--	@signing_name,
--	@signing_company,
--	@signing_title,
--	@signing_date,
--	GETDATE(),
--	GETDATE(),
--	@username,
--	@username,
--	@comments,
--	@sample_id,
--	@cust_name,
--	@cust_addr1,
--	@cust_addr2,
--	@cust_addr3,
--	@cust_addr4,
--	@cust_city,
--	@cust_state,
--	@cust_zip,
--	@cust_country,
--	@inv_contact_name,
--	@inv_contact_phone,
--	@inv_contact_fax,
--	@tech_contact_name,
--	@tech_contact_phone,
--	@tech_contact_fax,
--	@tech_contact_mobile,
--	@tech_contact_pager,
--	@tech_cont_email,
--	@generator_id,
--	@epa_id,
--	@sic_code,
--	@generator_name,
--	@generator_address1,
--	@generator_address2,
--	@generator_address3,
--	@generator_address4,
--	@generator_city,
--	@generator_state,
--	@generator_zip,
--	@generator_county_id,
--	@generator_county_name,
--	@gen_mail_address1,
--	@gen_mail_address2,
--	@gen_mail_address3,
--	@gen_mail_city,
--	@gen_mail_state,
--	@gen_mail_zip,
--	@generator_contact,
--	@generator_contact_title,
--	@generator_phone,
--	@generator_fax,
--	@waste_common_name,
--	@volume,
--	@frequency,
--	@dot_shipping_name,
--	@surcharge_exempt,
--	@pack_bulk_solid_yard,
--	@pack_bulk_solid_ton,
--	@pack_bulk_liquid,
--	@pack_totes,
--	@pack_totes_size,
--	@pack_cy_box,
--	@pack_drum,
--	@pack_other,
--	@pack_other_desc,
--	@color,
--	@odor,
--	@poc,
--	@consistency_solid,
--	@consistency_dust,
--	@consistency_liquid,
--	@consistency_sludge,
--	@ph,
--	@ph_lte_2,
--	@ph_gt_2_lt_5,
--	@ph_gte_5_lte_10,
--	@ph_gt_10_lt_12_5,
--	@ph_gte_12_5,
--	@ignitability,
--	@waste_contains_spec_hand_none,
--	@free_liquids,
--	@oily_residue,
--	@metal_fines,
--	@biodegradable_sorbents,
--	@amines,
--	@ammonia,
--	@dioxins,
--	@furans,
--	@biohazard,
--	@shock_sensitive_waste,
--	@reactive_waste,
--	@radioactive_waste,
--	@explosives,
--	@pyrophoric_waste,
--	@isocyanates,
--	@asbestos_friable,
--	@asbestos_no_friable,
--	@gen_process,
--	@rcra_listed,
--	@rcra_listed_comment,
--	@rcra_characteristic,
--	@rcra_characteristic_comment,
--	@state_waste_code_flag,
--	@state_waste_code_flag_comment,
--	@wastewater_treatment,
--	@exceed_ldr_standards,
--	@meets_alt_soil_treatment_stds,
--	@more_than_50_pct_debris,
--	@oxidizer,
--	@react_cyanide,
--	@react_sulfide,
--	@info_basis,
--	@D004,
--	@D005,
--	@D006,
--	@D007,
--	@D008,
--	@D009,
--	@D010,
--	@D011,
--	@D012,
--	@D013,
--	@D014,
--	@D015,
--	@D016,
--	@D017,
--	@D018,
--	@D019,
--	@D020,
--	@D021,
--	@D022,
--	@D023,
--	@D024,
--	@D025,
--	@D026,
--	@D027,
--	@D028,
--	@D029,
--	@D030,
--	@D031,
--	@D032,
--	@D033,
--	@D034,
--	@D035,
--	@D036,
--	@D037,
--	@D038,
--	@D039,
--	@D040,
--	@D041,
--	@D042,
--	@D043,
--	@D004_concentration,
--	@D005_concentration,
--	@D006_concentration,
--	@D007_concentration,
--	@D008_concentration,
--	@D009_concentration,
--	@D010_concentration,
--	@D011_concentration,
--	@D012_concentration,
--	@D013_concentration,
--	@D014_concentration,
--	@D015_concentration,
--	@D016_concentration,
--	@D017_concentration,
--	@D018_concentration,
--	@D019_concentration,
--	@D020_concentration,
--	@D021_concentration,
--	@D022_concentration,
--	@D023_concentration,
--	@D024_concentration,
--	@D025_concentration,
--	@D026_concentration,
--	@D027_concentration,
--	@D028_concentration,
--	@D029_concentration,
--	@D030_concentration,
--	@D031_concentration,
--	@D032_concentration,
--	@D033_concentration,
--	@D034_concentration,
--	@D035_concentration,
--	@D036_concentration,
--	@D037_concentration,
--	@D038_concentration,
--	@D039_concentration,
--	@D040_concentration,
--	@D041_concentration,
--	@D042_concentration,
--	@D043_concentration,
--	@underlying_haz_constituents,
--	@michigan_non_haz,
--	@michigan_non_haz_comment,
--	@universal,
--	@recyclable_commodity,
--	@recoverable_petroleum_product,
--	@used_oil,
--	@pcb_concentration,
--	@pcb_source_concentration_gr_50,
--	@processed_into_non_liquid,
--	@processd_into_nonlqd_prior_pcb,
--	@pcb_non_lqd_contaminated_media,
--	@pcb_manufacturer,
--	@pcb_article_decontaminated,
--	@ccvocgr500,
--	@benzene,
--	@neshap_sic,
--	@tab_gr_10,
--	@avg_h20_gr_10,
--	@tab,
--	@benzene_gr_1,
--	@benzene_concentration,
--	@benzene_unit,
--	@fuel_blending,
--	@btu_per_lb,
--	@pct_chlorides,
--	@pct_moisture,
--	@pct_solids,
--	@intended_for_reclamation
--    , newid()
--)


--GO
--GRANT EXECUTE
--    ON OBJECT::[dbo].[sp_FormWCR_Insert] TO [EQWEB]
--    AS [dbo];
--GO
--GRANT EXECUTE
--    ON OBJECT::[dbo].[sp_FormWCR_Insert] TO [COR_USER]
--    AS [dbo];



--GO
--GRANT EXECUTE
--    ON OBJECT::[dbo].[sp_FormWCR_Insert] TO [EQAI]
--    AS [dbo];

